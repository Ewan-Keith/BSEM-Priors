{
    "contents" : "#### BSEM model of holzinger-swineford data\nlibrary(dplyr)\nlibrary(rstan)\nlibrary(shinystan)\nlibrary(loo)\nlibrary(reshape2)\nlibrary(ggplot2)\nlibrary(GGally)\nlibrary(ggthemes)\nlibrary(lme4)\nlibrary(arm)\nlibrary(OpenMx)\n\nrstan_options(auto_write = TRUE)\noptions(mc.cores = parallel::detectCores())\n\n\n#### load and prep data ####\ndata(HS.ability.data)\n\n# remove unused variables\nholz_dat <- HS.ability.data %>% \n  dplyr::select(\n    -id, -Gender, -grade, -agey, -agem,\n    -paperrev, -flagssub,\n    -deduct, -numeric, -problemr, -series, -arithmet)\n\n# split out into schools\ngrant_dat <- holz_dat %>% filter(school == 'Grant-White')\npast_dat <- holz_dat %>% filter(school == 'Pasteur')\n\n# standardise each dataset individually\ngrant_dat_stand <- scale(grant_dat[,-1])\npast_dat_stand <- scale(past_dat[,-1])\n\n# clean work space\nrm(HS.ability.data, holz_dat, grant_dat, past_dat) \n\n\n#### grant school analysis ####\n\n# prep data for stan\nstan_grant_dat <- list(N = 156,\n                 P = 19,\n                 D = 4,\n                 C = 57,\n                 X = grant_dat_stand\n)\n\n# fit Gaussian model\nfit_grant <- stan(file = 'H&S analysis/models/H&S Gaussian.stan', \n                  data = stan_grant_dat, \n                  iter = 3000, chains = 3, thin = 3,\n                  control = list(adapt_delta = 0.9))\n\n# fit horseshoe model\nfit_grant_hs <- stan(file = 'H&S analysis/models/H&S horseshoe.stan', \n                  data = stan_grant_dat, \n                  iter = 3000, chains = 3, thin = 3,\n                  control = list(adapt_delta = 0.999))\n\n# fit horseshoe plus model\nfit_grant_hs_plus <- stan(file = 'H&S analysis/models/H&S horseshoe plus.stan', \n                          data = stan_grant_dat, \n                          iter = 3000, chains = 3, thin = 3,\n                          control = list(adapt_delta = 0.999,\n                                         max_treedepth = 15))\n\n## save models\n# saveRDS(fit_grant_hs, file = 'H&S analysis/models/fitted models/fitted H&S horseshoe.rds')\n# saveRDS(fit_grant, file = 'H&S analysis/models/fitted models/fitted H&S gaussian.rds')\n# saveRDS(fit_grant_hs_plus, file = 'H&S analysis/models/fitted models/fitted H&S horseshoe plus.rds')\n\n\n",
    "created" : 1468525680007.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "904082507",
    "id" : "FD4B5ADE",
    "lastKnownWriteTime" : 1468950096,
    "path" : "~/GitHub/BSEM Priors/H&S analysis/H&S analysis.R",
    "project_path" : "H&S analysis/H&S analysis.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "type" : "r_source"
}